# PiTaPa利用チェックツール (PiTaPa Checker) v55

PiTaPa倶楽部からダウンロードした利用明細CSVを読み込み、**「定期区間との重複」**や**「休日利用」**を自動判定するWebアプリケーションです。

建設コンサルタントや鉄道関連企業の事務作業における、通勤定期代の二重払いチェックや不適切な交通費精算の監査を大幅に効率化します。

## 🚀 主な機能

- **自動重複判定**: 登録された定期区間と、実際の利用経路を比較し、2駅以上連続して一致する区間があれば自動でアラート。
- **高度な経路探索**: 
  - 大阪メトロ〜阪急などの事業者またぎ区間に対応。
  - 相互直通運転（江坂、天神橋筋六丁目など）を考慮した駅間グラフ構造による最短経路探索。
- **休日・深夜判定**: 土日祝日および年末年始（12/29〜1/3）の利用を自動判別。
- **ゆらぎ吸収ロジック**: 
  - 「大地下鉄」→「大阪メトロ」などの事業者略称を自動変換。
  - 駅名の「市」や「駅」の有無、カッコ書き（副駅名）の表記揺れを補完。
- **効率的なリスト管理**:
  - 未提出者、社員登録なし、重複あり、その他要確認、確認済みのステータス別自動仕分け。
  - ダブルクリックによる「確認OK」フラグのトグル管理。
- **外部連携**: アラートが出た区間をクリックすると、Yahoo!路線情報の検索結果を別タブで即座に表示。
- **プロ仕様の出力**: 
  - A4縦サイズに最適化された高密度印刷レイアウト。
  - Excelでの加工を前提とした解析結果のCSVエクスポート（入場記録なし時間の補正機能付き）。

## 🛠 使い方

1. **CSVの取込**
   - [1. CSV取込] タブから、PiTaPa倶楽部のCSVファイルを読み込みます。フォルダごと指定して複数人分を一括処理可能です。
2. **定期・設定の登録**
   - [2. 定期・設定] タブで、社員名と定期区間（発駅・着駅）を登録します。
   - **注意**: 社員名はCSVの「〇〇 〇〇 様ご利用分」の表記と完全に一致させてください。
3. **結果の確認**
   - [3. 結果確認] タブで集計結果をレビューします。
   - 背景が赤い行は「定期重複」や「休日利用」など、何らかの確認が必要です。
4. **データの保存**
   - 登録した社員情報は「設定データ操作」からCSVとしてバックアップでき、次回以降の作業をショートカットできます。

## 📝 ライセンス・注意事項

### 禁止事項
- **商用利用禁止**: 本ツールの商用目的での利用（サービスとしての提供等）は許可されていません。
- **転売禁止**: 本プログラム、または改変したプログラムを第三者に販売・転売することを固く禁じます。

### 免責事項
本ツールの判定結果は、独自の経路探索アルゴリズムに基づいた参考値です。運賃改定や路線の新設等により判定が正確でない場合があります。最終的な支払・監査判断は必ず担当者が目視で行ってください。

## 🆙 更新履歴

### v55
- **日付処理の強化**: CSV内で「2026/01/14」と「2026/1/14」のようにゼロ埋めの有無が混在していても、同一月として正しく集計されるようロジックを修正。
- **操作性の改善**: リスト内のダブルクリック判定（確認OKへの移動）をより安定化。

---
Developed as an adaptive AI collaboration project.
